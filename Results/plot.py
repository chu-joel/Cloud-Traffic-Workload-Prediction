import seaborn as sns
from matplotlib import pyplot as plt, rcParams
import numpy as np
from sklearn import preprocessing

from sklearn.metrics import mean_absolute_error, mean_squared_error

# 50epochs epochs = 10, best epochs=7, patience=3
training =[2.2638633440309137, 0.4855397860104131, 0.13451137434881671, 0.06130953668410729, 0.03765170381502633, 0.026136071105179157, 0.01928264263497568, 0.014754783908773283, 0.011542122478817932, 0.009241494560028539]
validation = [2.4047498989168723, 0.3259267855576583, 0.061568359870834234, 0.018756513856962934, 0.008590273234673476, 0.006332816327135255, 0.005755580928620264, 0.005764504412724323, 0.005941452037557047, 0.006100535048231426]
testing = [0.020027149638337967, 0.0017790334499917433, 0.0005646025951389454, 0.0003355557074026557, 0.00011961875254859327, 0.00015016517600237054, 6.555046449280045e-05, 6.78577347494455e-05, 5.051558374066022e-05, 9.933571706467283e-05]

bestPredicted = [0.026141096, 0.023618206, 0.022288874, 0.028078113, 0.017930374, 0.019062512, 0.013874223, 0.023659315, 0.020967726, 0.020749088, 0.021112397, 0.016534423, 0.014597452, 0.022425938, 0.016820882, 0.013666614, 0.019335922, 0.025776181, 0.021531504, 0.016018683, 0.022355001, 0.019288184, 0.02636068, 0.018230345, 0.025530785, 0.021199008, 0.024933206, 0.013103521, 0.022706995, 0.021904076]
predictedActual = [0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]


#Encoding layers=1

#Patiecne=1
training =[3.206191316127712, 2.1795980139350797, 1.6376478496924534, 1.1645417569931775, 0.7366355483699704, 0.43471198826466373, 0.26111752902159757, 0.17415450176602432, 0.13021226480974651, 0.1039569898574362, 0.0819732671049384, 0.06267614366479445, 0.047430694064642426, 0.03661079624060317, 0.02885083854215647, 0.023544837848628593, 0.02001661655802211, 0.017334118382247597, 0.014996486662420159, 0.013332544851915847, 0.01187869486619702, 0.010694652294034936, 0.009798234399579298, 0.009151576942186759, 0.008567090765075074, 0.008098883767605305, 0.007566274994300153, 0.007229673919488112, 0.006832801683178872, 0.006747612625108368]   
validation = [3.3510827174213875, 2.298297701130065, 1.7344877360410142, 1.3043246411780294, 0.9431713339265881, 0.6822887083426429, 0.5221386346337605, 0.42766148012764343, 0.3573815868378427, 0.29244006340011947, 0.2267030352855894, 0.17264226097476718, 0.1368896752497588, 0.10981963776456423, 0.09113774034460681, 0.07759629588527807, 0.06709381361214216, 0.058696354416218996, 0.05149619965169572, 0.04596859172909942, 0.04100444022225894, 0.037083564811379324, 0.03369710085211661, 0.030732106751110027, 0.028036338182758053, 0.025565939380197016, 0.023708482450347693, 0.021777992039545477, 0.020124350514481883, 0.01867186367983206]
testing =[0.06330874566755622, 0.06256487336618506, 0.028209028989264636, 0.021617295380341957, 0.01183992157205849, 0.01430283579197778, 0.0067622409989494805, 0.003744148984469962, 0.0022957805778165397, 0.0013045016739682746, 0.0009151537279344397, 0.0010800441358688163, 0.0008365929423733707, 0.0005190032556666053, 0.0003199395084517831, 0.00024418347031204325, 0.00016334386935979312, 0.00011596587977001538, 0.00010205317206246129, 0.0001247037353798428, 8.485553856287501e-05, 0.00011676668779910574, 0.00010915191711262651, 6.044759742940763e-05, 5.714295269880576e-05, 7.330594217161334e-05, 4.598737075062489e-05, 0.00011170703374867378, 3.912550645637752e-05, 4.584859020256489e-05]
bestPredicted = [0.015186267, 0.023711156, 0.015973523, 0.018725153, 0.016739681, 0.01963405, 0.019898398, 0.029736131, 0.018649604, 0.017976863, 0.016152538, 0.016250387, 0.020929685, 0.021083042, 0.011075109, 0.017353252, 0.020031666, 0.023524076, 0.018014684, 0.0260336, 0.015681708, 0.027411884, 0.017989801, 0.014551846, 0.017578784, 0.017258584, 0.014072029, 0.016444495, 0.018658448, 0.02309357]
predictedActual = [0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]
bestPredicted = [0.015186267, 0.023711156, 0.015973523, 0.018725153, 0.016739681, 0.01963405, 0.019898398, 0.029736131, 0.018649604, 0.017976863, 0.016152538, 0.016250387, 0.020929685, 0.021083042, 0.011075109, 0.017353252, 0.020031666, 0.023524076, 0.018014684, 0.0260336, 0.015681708, 0.027411884, 0.017989801, 0.014551846, 0.017578784, 0.017258584, 0.014072029, 0.016444495, 0.018658448, 0.02309357]

#lr=0.000001
# training =[3.6393854435732975, 2.711972198337273, 2.402516681229756, 2.2056770357752113, 2.025074902647885, 1.8688386986409689, 1.7186619008914485, 1.5877947261440981, 1.4711663861077795, 1.3487458398425656, 1.23210101766712, 1.1394644410781143, 1.0335941195186606, 0.9453813268904874, 0.8487106540934035, 0.7695209121317531, 0.6928388110677189, 0.6193792504833817, 0.5568725289882416, 0.4975968576785998, 0.44795856598564193, 0.4004385890767061, 0.3576627712870886, 0.3215907219619492, 0.28625716049953925, 0.25937982159581796, 0.2311437831603518, 0.21204020049959094, 0.19162771952907987, 0.17497286882762544, 0.1615972421410902, 0.15056732810130027, 0.13987639674981564, 0.12942713848865386, 0.12128626784826445, 0.11437186681207948, 0.10746474403845255, 0.10022270420782439, 0.09381027459971399, 0.08790541875405083, 0.0816410121326099, 0.07546524784691713, 0.07029112586744363, 0.06442554599618903, 0.05915089464804571, 0.054286701244599084, 0.04959498810238605, 0.044744584070217044, 0.04065691111359546, 0.03673743929365319, 0.03300101877381495, 0.030185554488377158, 0.027218734599157527, 0.02470744938597025, 0.022816553197260985, 0.020906513709919826, 0.019204621987437824, 0.017665215630465452, 0.01630763430849401, 0.015167967529063374, 0.014159039292245946, 0.013280951780059789, 0.012486398563097502, 0.011827486221262368, 0.01111929581257919, 0.010559542885609079, 0.010138675509055726, 0.009632911534060873, 0.009247428360702286, 0.008923078376734304, 0.008556841599591629, 0.00823887865252119, 0.007968660119848914, 0.007688834166071551, 0.0074605725716543145, 0.007242112364284299, 0.007036550264936554, 0.006810003817062144, 0.006680450703065103, 0.006552487703189621, 0.00636656453046305, 0.006286357056631228, 0.006136339881706579, 0.006045153053530321, 0.005886609046496921, 0.005838130513951796, 0.005767327372010354, 0.005614607417768219, 0.005509565461435121, 0.005440400225589999, 0.0053704398779518825, 0.005302281564872238, 0.0052219321820715404, 0.005132736982475196, 0.005118571522445305, 0.005042974898220722, 0.004988094000259351, 0.004943353217156935, 0.004900584793117742, 0.004880602913375338, 0.004809708566079547, 0.0048452182911078, 0.004770026724961524, 0.004746748202480369, 0.0046814801484508905, 0.004660211585454867, 0.004663615098698545, 0.0046039123742101, 0.004591622819323604, 0.004542524675600992, 0.004516349794214038, 0.004520030766198375, 0.004456042979975469, 0.0044903728301617435, 0.004503161938098328, 0.00448414242100316, 0.004471603755991281, 0.004424167931662812, 0.00448995181728801]
# validation = [3.842477398291219, 2.932324586868787, 2.5851565721171212, 2.3513992148586826, 2.151017921709875, 1.9764650816376876, 1.835207817900894, 1.707109782363829, 1.578056237395154, 1.463071460223552, 1.3615158541545034, 1.248477719278417, 1.1594799408304546, 1.0725483381778587, 0.9980591001816642, 0.9190530541338544, 0.8439427653403274, 0.7829650806212536, 0.7221806745806955, 0.6673853832204439, 0.6220400653503559, 0.5770189231748988, 0.542912739917942, 0.5040995473423933, 0.4751374311706065, 0.44883102803868247, 0.41833641955762774, 0.3972335474816715, 0.3706755223486409, 0.3525276704840636, 0.33106973794428446, 0.3127009431429488, 0.2965152879034848, 0.27842547121619887, 0.2609700812810292, 0.24594076097621556, 0.23021598836952537, 0.21325960871536598, 0.19969328991149315, 0.18439888471198737, 0.17279778087386252, 0.15988016306397654, 0.14701331680824078, 0.1372356855179648, 0.1261751630408713, 0.11640789878075225, 0.1076066576484588, 0.10067598698142631, 0.09266441407972216, 0.0859219514672537, 0.0805431293324474, 0.07543223699386384, 0.07071648396563898, 0.06679305487796541, 0.06271112384630709, 0.05949379151600723, 0.05633528194307705, 0.053671664041787505, 0.05094106442187904, 0.04815017480139527, 0.04606047779149064, 0.04356208300207652, 0.04157286191610252, 0.03975006033023905, 0.038119524595347086, 0.03657813751694412, 0.03519710957359376, 0.03335849292272436, 0.031948966240114576, 0.030849075621455654, 0.029474005671903718, 0.028344748913040806, 0.027152606898890538, 0.026310979123599466, 0.025077737360276044, 0.024231949397068808, 0.023296283075103053, 0.022555673380631913, 0.021819437982329885, 0.02096827838805608, 0.020294831625456408, 0.019474677010252905, 0.018791026664677992, 0.018222486738881945, 0.017653906486776526, 0.016874332936041583, 0.016316907028139056, 0.015850678848662404, 0.015329959493459739, 0.014896346862529974, 0.01459839404141677, 0.013880027688633048, 0.01343414499551479, 0.013045245001807837, 0.012594408963093736, 0.01230324050092483, 0.012005542082673511, 0.011624557465058747, 0.011372017580198875, 0.010960006106388333, 0.010638431711320695, 0.01040849318721008, 0.010015957922918962, 0.009695553913155859, 0.009493453950141631, 0.009211644854021343, 0.009032727595205587, 0.008817036072513395, 0.008529872609217774, 0.00829104874135396, 0.008112771350827276, 0.00790908514302906, 0.0077353896738181814, 0.007491579630330048, 0.007348626807504786, 0.0071749970449937975, 0.007015799037897243, 0.006850826685969163, 0.006688973525204441]
# testing = [0.0875275055264593, 0.09018488578793497, 0.06368297784189152, 0.05909535772196007, 0.05797103303074266, 0.04780432617543271, 0.05335636954555205, 0.03078974942146074, 0.050753223936995114, 0.028724991672769026, 0.02409742861169671, 0.03404639144115266, 0.031164532448669482, 0.025266392014253326, 0.02339760007228001, 0.025204352900707345, 0.017716521305673933, 0.025540659320653306, 0.019411378862625058, 0.013626865827054867, 0.010820663387889475, 0.014593796737227748, 0.014555917369060813, 0.010000521932985973, 0.009283391888137872, 0.007730836394315492, 0.008483183531746723, 0.007929924071295183, 0.005609066226937908, 0.005616521652531585, 0.004989099894127341, 0.004822721019987205, 0.0037500930960838517, 0.004399400817634674, 0.0019372916658694198, 0.0022510006565690326, 0.0026188122852409466, 0.002820524716211912, 0.0034249203841640046, 0.00277045797786158, 0.002183553151847579, 0.0030469440401197246, 0.002007524788267454, 0.002267859242033185, 0.0028591561388522043, 0.0024409145116028597, 0.0014702029823521476, 0.0020584089104519893, 0.001966203983019126, 0.0011284231702383685, 0.0007704839908420503, 0.0007314570859591462, 0.0014875553907104132, 0.0006609085790644034, 0.0007127619961046493, 0.0009412967338317792, 0.00041295413655321686, 0.0002912662244900748, 0.00016545773978873308, 0.0002868532284955053, 0.00011638017783935169, 0.00016157049094953443, 0.00019373892267117101, 9.048579451974504e-05, 0.00018652797714796063, 0.00011032167115869548, 0.00019097986937650788, 7.749953229743402e-05, 9.165663791272043e-05, 8.778926634412178e-05, 0.0001074107966363478, 0.00010047366638806976, 6.980532220368643e-05, 4.5424468771353275e-05, 8.3136562523508e-05, 6.491079526056667e-05, 6.875337208433323e-05, 7.135407645984546e-05, 5.8323017344145634e-05, 5.840458880231905e-05, 5.833098098121681e-05, 7.325141550714198e-05, 8.89430556310557e-05, 9.448365867217516e-05, 4.637601349532375e-05, 4.690528815977397e-05, 5.162431108941836e-05, 5.09878780371844e-05, 5.9380177990196716e-05, 3.3285492749090924e-05, 3.591187464153791e-05, 4.964968343156378e-05, 0.0001047967384336572, 3.125397561518085e-05, 4.756262544093247e-05, 3.306452741503485e-05, 6.80258415668494e-05, 5.231458853807345e-05, 0.00010197640843187041, 5.647194126263642e-05, 4.6971154797350104e-05, 5.929364653038768e-05, 4.468561470527651e-05, 5.571629553728585e-05, 3.73098237742665e-05, 3.310074615590268e-05, 8.486256573357773e-05, 0.00014987163467722865, 0.00010605808361217792, 8.80828039951647e-05, 9.376364538166366e-05, 7.357692460148575e-05, 0.00011060686729630002, 4.14765101328849e-05, 7.209920990035722e-05, 0.00010883278375822384, 6.338867969646712e-05, 4.8953928695327777e-05, 4.05559184238669e-05]
# bestPredicted = [0.017232465, 0.010644969, 0.021903662, 0.015536804, 0.0112735, 0.01828056, 0.018119007, 0.022423897, 0.013423045, 0.01552818, 0.020845927, 0.012793753, 0.018751387, 0.009760294, 0.020788804, 0.010421609, 0.012871956, 0.013767391, 0.010514794, 0.014085298, 0.017238036, 0.023886979, 0.012883404, 0.021564296, 0.009845503, 0.015617231, 0.02279437, 0.016758062, 0.01803185, 0.019032238]
# predictedActual = [0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]

#lr=0.00001
# training=[2.373680343265156, 0.9745084811725442, 0.3439931860398168, 0.13871592787012227, 0.06951552107107034, 0.027414019572200053, 0.013081118829079245, 0.008454000256629344, 0.00666046561502151, 0.00549202820442521, 0.005018816954090967, 0.004695496514574918, 0.004564741270891426, 0.0044638213224628895, 0.004459081379687338, 0.004449743440188601, 0.004405580576096224, 0.004295289865449525, 0.004125337131369122, 0.003945477485695439, 0.0038533356749248693, 0.0036540265362644546, 0.0034973789132107897, 0.0033523369889837634, 0.003233037455374578, 0.003115466954036521, 0.0030519609411223747, 0.002953160703780054, 0.0028376416195443335, 0.00281981943078163, 0.002803936683864393, 0.0027654501857220528, 0.0027306374553618036, 0.00270573875136864, 0.0027421974245846552, 0.002647393703671731, 0.002640366533878012, 0.002651783491967568, 0.0025916595331252077, 0.0025905187388866424, 0.0025442411990050187, 0.002573641936665875, 0.002553601775059819, 0.002591132345466907]
# validation = [2.5198813263739686, 1.1098361362052798, 0.5287921522446686, 0.2904042970148372, 0.14265367029407094, 0.06945471641909086, 0.041896895366676304, 0.027509672471029832, 0.01951421645329895, 0.014111214489813614, 0.010648878486618938, 0.008183506905605514, 0.006538346764524877, 0.005378865972620042, 0.004570494907232098, 0.003988904779485622, 0.003578772089891119, 0.0032851800819135037, 0.0030292347572540143, 0.0028740981249352378, 0.0027484783289109466, 0.002639804884064341, 0.002557901735211998, 0.002465428540157542, 0.0024056214863977287, 0.002327152382231766, 0.0023080890132465334, 0.0022775963917565233, 0.002220622248152395, 0.002198796043498508, 0.0021894486507642095, 0.0021698314293262227, 0.002166446318546725, 0.002143154951675458, 0.002138133814698403, 0.0021045582306145096, 0.0021148391433509946, 0.002111870875682088, 0.002104524675397043, 0.0020868573470547666, 0.0020870208921198318, 0.0020870380640365905, 0.0020655874219195486, 0.0020688535097095773]
# testing = [0.04402554006908182, 0.02425590605639459, 0.006024873910797287, 0.0023442016855814, 0.002838696094713314, 0.0011217056414625376, 0.0002801940931164307, 0.00011985845605721999, 3.923680506020661e-05, 7.63697568116124e-05, 8.623368585690575e-05, 7.57288658253546e-05, 5.658830619380697e-05, 7.02603186395114e-05, 5.380754548111626e-05, 5.551684351371266e-05, 5.899698016847577e-05, 5.777518778712754e-05, 0.00011047878915035384, 8.186854141662846e-05, 6.850709158236283e-05, 5.8956698032601436e-05, 5.3999730896470153e-05, 5.850383820484643e-05, 8.887229407689437e-05, 7.13269210364935e-05, 6.920410554651143e-05, 7.201831779503503e-05, 4.710776388689192e-05, 3.728545033218647e-05, 5.152608357602841e-05, 4.008744907321017e-05, 4.644116736004999e-05, 4.794210395031104e-05, 5.6454355150195824e-05, 4.251767035481629e-05, 4.3327624851117686e-05, 4.6159724892552955e-05, 5.384677760456523e-05, 7.661843078512683e-05, 5.201413234604531e-05, 5.486306612320374e-05, 4.8355394888089805e-05, 7.436459562842132e-05]
# bestPredicted = [0.01841704, 0.01955321, 0.0175063, 0.019793289, 0.019534647, 0.018575296, 0.018673407, 0.020350637, 0.01884897, 0.019393165, 0.019722436, 0.02185185, 0.019014709, 0.021097599, 0.021107538, 0.020890564, 0.021463547, 0.018054483, 0.020650027, 0.020829776, 0.021642426, 0.0201298, 0.01991602, 0.019406501, 0.019716077, 0.018447183, 0.018861374, 0.021315444, 0.020738827, 0.020214371]
# predictedActual = [0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]
# predictedActual =[0.022882784, 0.025184307, 0.022759935, 0.022008, 0.023317736, 0.022718128, 0.023268571, 0.0246224, 0.022347044, 0.022647446, 0.023840673, 0.02421835, 0.022703173, 0.024023257, 0.022645079, 0.02473744, 0.025658378, 0.024077669, 0.024426732, 0.023817921, 0.024341032, 0.023654057, 0.024280261, 0.022661079, 0.022046264, 0.02390066, 0.023713155, 0.023347735, 0.024419103, 0.023287721]

#encoding layers=2 lr=0.00001
# training=[2.3176371356668155, 0.5258716372071509, 0.11098141220330522, 0.0414528516299211, 0.018861368728953012, 0.011656601464261559, 0.008662291085994513, 0.007207032419805286, 0.006394067567345097, 0.0059378575415263745, 0.00575362658231672, 0.005650445384794605, 0.005656719058064587, 0.005626493052844981, 0.005694930087625697]
# validation = [2.425683269250123, 0.756753361944379, 0.3045451874772252, 0.11919057829907978, 0.06078946266520513, 0.038597435569107164, 0.026779546630093295, 0.019560367791637084, 0.014870356057518762, 0.011483165178363335, 0.009077228855562738, 0.007298596912685587, 0.006075977039698194, 0.005111846420379775, 0.00449151071825313]
# testing = [0.02739556546677841, 0.007489741178261117, 0.0008751255588205075, 0.00021374070024885122, 0.00017415647835340587, 7.6067144045416e-05, 5.0951930025429485e-05, 6.13864027775119e-05, 3.9949561950222005e-05, 0.0001268504280418772, 4.8117183092986194e-05, 3.1222474925909086e-05, 4.649924811108058e-05, 1.8653046633133298e-05, 0.0001195542459901312]
# bestPredicted = [0.020907123, 0.019924322, 0.01980737, 0.016110657, 0.017509215, 0.015953245, 0.015510717, 0.016233537, 0.016030777, 0.017858485, 0.016921904, 0.017330946, 0.017934183, 0.013048932, 0.017209273, 0.015694242, 0.017463095, 0.021388194, 0.019081736, 0.01847551, 0.017604334, 0.02081742, 0.018371645, 0.01600171, 0.015746951, 0.016901284, 0.01571966, 0.013907503, 0.015851563, 0.015408134]
# predictedActual =[0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]
# predictedActual =[0.019493163, 0.022230057, 0.020016411, 0.01870577, 0.020235796, 0.021962948, 0.023563959, 0.024631778, 0.021080911, 0.01840344, 0.024937175, 0.01961956, 0.017434381, 0.0222127, 0.021396695, 0.019050663, 0.022831589, 0.022800153, 0.023124833, 0.022468328, 0.021302981, 0.021347571, 0.021396412, 0.021870501, 0.018977769, 0.021987189, 0.020040981, 0.022794468, 0.021466982, 0.021186335]

#lr=0.000001
# training=[3.671294516910196, 2.735333675620611, 2.4343654540367723, 2.1973562308760632, 1.9547553674257911, 1.7555349132318367, 1.549499651695787, 1.350148090999172, 1.1649687012455274, 0.9846417833443069, 0.8111178405799503, 0.6598419106554474, 0.5260101241823664, 0.4176990015977217, 0.3373523521079104, 0.2773879380921495, 0.23323568304363881, 0.199481599495743, 0.17319941960120727, 0.15198007167717167, 0.13396831094522307, 0.12085871497346454, 0.10707841475453068, 0.0980313665685487, 0.08943449299898583, 0.08268256103727831, 0.07401543468330561, 0.06754948182489243, 0.06031568363821201, 0.0549478978258067, 0.04946051798986128, 0.044797931693266006, 0.04027081931956657, 0.036653789542313665, 0.03351707698251135, 0.030817559897715306, 0.028417119910979356, 0.02649814231270864, 0.024328211847903444, 0.02304214246371152, 0.021828979302732393, 0.020175293656241253, 0.018892789502717455, 0.017685515339319238, 0.016956365863214667, 0.01616879401419245, 0.01543798737197845, 0.014418583318123606, 0.013854394630791089, 0.013279832056863384, 0.012526526890087868, 0.012086462678105812, 0.011567253903326542, 0.011209775415456289, 0.01058772959452314, 0.010380518213006699, 0.010118949114164121, 0.009873395461446362, 0.0094364201617652, 0.009168277747315589, 0.008826257690607847, 0.008635289288745802, 0.008379002146014962, 0.00811667960982133, 0.007989162096227503, 0.007808210891236977, 0.007622226648793641, 0.0075033008807536055, 0.007351098057273105, 0.0071455405326824985, 0.007054429131737573, 0.006926141110160341, 0.006871204076333003, 0.00674501248329654, 0.006654489258139085, 0.006510551137645161, 0.006453164633981797, 0.0063713524021873184, 0.006284030727239272, 0.006208370678511634, 0.006182550530518666, 0.006106986411345656, 0.006061606640221122, 0.005954635988716785, 0.005923093525449639, 0.005917186495345743, 0.005823361751732328, 0.005772006029728846, 0.005722691546782801, 0.005650034168374054, 0.005674205905443108, 0.005614190014423696, 0.0055525931248097, 0.005587674164444583, 0.0055907949597756796, 0.0056223227350606165]
# validation = [3.836158216812922, 2.920605771007844, 2.545802867292804, 2.2951927659732863, 2.0591035246277056, 1.8485520883807, 1.6443028220852949, 1.4737532152364878, 1.2980640288601575, 1.1492431679887738, 0.9992261674114925, 0.8702298911713753, 0.7586724968337463, 0.6705065215924526, 0.595709615727069, 0.5456792172248404, 0.4995904227095595, 0.4677269120070419, 0.4296852284482411, 0.39825313980946, 0.36468230243249977, 0.3363430146739604, 0.30584558923496247, 0.2801541047859789, 0.2535012299696274, 0.23048151489796892, 0.20906529202107674, 0.1887914425736604, 0.16953888924618965, 0.15432805387161627, 0.14247891353603861, 0.12981506878355664, 0.12080419449307989, 0.11084629600390866, 0.10307447994059442, 0.09673382468719338, 0.08982280576214795, 0.08500926199396085, 0.0798861838953729, 0.07576201853594701, 0.07086374618817992, 0.06733773597780755, 0.06383520865558456, 0.06053999832288506, 0.057555765304437935, 0.05481191976997185, 0.0529647511560657, 0.05005434588866423, 0.04793804556004003, 0.045655214996087594, 0.04400075508108702, 0.04176252285929916, 0.04049416207456351, 0.03852427934485934, 0.03721540327794031, 0.035762360989114596, 0.034362096802192835, 0.032724669315580046, 0.03178771753412945, 0.030677537064220658, 0.029458414394956448, 0.028622203823952665, 0.027560586064720456, 0.02651034451372869, 0.025478577700050173, 0.024703595895375477, 0.023918541335924054, 0.02330376400719406, 0.02238890944680816, 0.021824931885269558, 0.020914553721357303, 0.020437369073735133, 0.01974379987461351, 0.019136320311583948, 0.018634473714555202, 0.018131653722395183, 0.017599238162122367, 0.017087514111551533, 0.016672297614777547, 0.016089527743970055, 0.015600773801853662, 0.015141648651306119, 0.014851181755591759, 0.014383071201248352, 0.013853817589484375, 0.01363560935661972, 0.013239524723299452, 0.012933305449183868, 0.012610318457735971, 0.01227174997259189, 0.011970805756356425, 0.01159511212926916, 0.011309560285125657, 0.010961356710850375, 0.010852933129464544, 0.010536105210594286]
# testing = [0.07823320945523868, 0.0902542165352825, 0.051489343895093985, 0.044209527558010664, 0.03733082643849296, 0.047683282430903924, 0.03453016504032747, 0.03308735077877687, 0.024060802404462726, 0.01744440886853184, 0.0187270769772617, 0.017113171901245894, 0.01733892289316388, 0.012547041746809885, 0.010107818105208794, 0.010757228458766699, 0.006476725193879062, 0.006461457182966349, 0.007180122794181212, 0.004320964294808613, 0.0034635232418786612, 0.0025880448092205494, 0.0022420064288657454, 0.0028137173333427105, 0.0010813768850341844, 0.0014030329070266869, 0.003667808717274965, 0.0007845054771258743, 0.0009031370354160236, 0.0005509304806755181, 0.00047951308852271356, 0.0007326722928334819, 0.00026003348302819785, 0.00044692887439110995, 0.0004117596961235313, 0.0003345117462743161, 0.0002716805027184492, 0.00020170041918252858, 0.00028455997878525715, 0.00018203824400728503, 0.0002512819789790711, 0.0001964826805635447, 0.000222097695672839, 0.00011908333472619451, 8.839976077898924e-05, 8.272568175858003e-05, 9.371635934152963e-05, 6.478509682551727e-05, 9.867473493715e-05, 8.307691789453667e-05, 0.00010271865421843352, 7.127162982449464e-05, 6.325981326542675e-05, 0.00011971731449935284, 8.34373772229874e-05, 9.345988024584911e-05, 0.0002386068562898627, 0.00019218932743008318, 0.0001664919290891488, 6.791695613920535e-05, 0.00019730423483480832, 0.00036676979630991674, 0.00011331994228833855, 9.481394691627e-05, 6.650500889180023e-05, 0.0001088752293182196, 0.0001421776241265963, 9.22152433719747e-05, 0.0002229608094196095, 0.00015232399624268709, 5.0370981281965936e-05, 0.0001476488619464941, 3.359928198784494e-05, 6.970357936154606e-05, 0.00010760678377460335, 5.118542268706776e-05, 0.00012480638804403954, 6.764412765524592e-05, 9.433628771851197e-05, 6.763773893555317e-05, 3.832965674744982e-05, 5.7244637957944816e-05, 9.695136557753733e-05, 7.586307474403952e-05, 5.4572902561649305e-05, 3.412741778467986e-05, 5.3410638203065216e-05, 0.0001042767121213918, 6.289295774947457e-05, 5.1386526160536465e-05, 5.8036915475947055e-05, 8.80153089433323e-05, 4.4234132684430395e-05, 5.3925836637129147e-05, 0.0001107375791479162, 6.516953649854063e-05]
# bestPredicted = [0.018890135, 0.013666094, 0.014758332, 0.020496087, 0.01592068, 0.021162974, 0.019415148, 0.025074396, 0.01759094, 0.018992525, 0.014131634, 0.014317667, 0.022418074, 0.01652564, 0.012579436, 0.015059882, 0.019432332, 0.023060577, 0.0148536805, 0.019279512, 0.017938355, 0.02363539, 0.020661786, 0.014963135, 0.00790159, 0.01637096, 0.011387151, 0.01508504, 0.011664251, 0.023186157]
# predictedActual =[0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]
# predictedActual =[0.017903386, 0.019085435, 0.024513971, 0.018726474, 0.013694128, 0.014921926, 0.02538891, 0.034408618, 0.026162488, 0.022066744, 0.023415253, 0.022396369, 0.020904183, 0.02621937, 0.023369677, 0.017238412, 0.026095567, 0.027542198, 0.025736645, 0.027535059, 0.020038636, 0.030040173, 0.030718194, 0.025993947, 0.023542015, 0.018456666, 0.018560898, 0.019868538, 0.021990024, 0.02422759]

#lr=0.0000025
# training=[3.206191316127712, 2.1795980139350797, 1.6376478496924534, 1.1645417569931775, 0.7366355483699704, 0.43471198826466373, 0.26111752902159757, 0.17415450176602432, 0.13021226480974651, 0.1039569898574362, 0.0819732671049384, 0.06267614366479445, 0.047430694064642426, 0.03661079624060317, 0.02885083854215647, 0.023544837848628593, 0.02001661655802211, 0.017334118382247597, 0.014996486662420159, 0.013332544851915847, 0.01187869486619702, 0.010694652294034936, 0.009798234399579298, 0.009151576942186759, 0.008567090765075074, 0.008098883767605305, 0.007566274994300153, 0.007229673919488112, 0.006832801683178872, 0.006747612625108368, 0.006505766055371647, 0.006348945011383461, 0.006163244222690425, 0.006128130108287765, 0.005930073994402083, 0.0058106090394866, 0.005748312528483723, 0.005645579082144224, 0.005602215704876969, 0.005636137277991903, 0.0055944082461792475, 0.005478720335575973, 0.005494342491432143, 0.005475714728377744, 0.005464398383244187, 0.00548375223299081, 0.005409988668934421, 0.005414488754674763, 0.005441164250885953, 0.005488033056974819]
# validation = [3.3510827174213875, 2.298297701130065, 1.7344877360410142, 1.3043246411780294, 0.9431713339265881, 0.6822887083426429, 0.5221386346337605, 0.42766148012764343, 0.3573815868378427, 0.29244006340011947, 0.2267030352855894, 0.17264226097476718, 0.1368896752497588, 0.10981963776456423, 0.09113774034460681, 0.07759629588527807, 0.06709381361214216, 0.058696354416218996, 0.05149619965169572, 0.04596859172909942, 0.04100444022225894, 0.037083564811379324, 0.03369710085211661, 0.030732106751110027, 0.028036338182758053, 0.025565939380197016, 0.023708482450347693, 0.021777992039545477, 0.020124350514481883, 0.01867186367983206, 0.01734724452047099, 0.016162596670831114, 0.015049835163961679, 0.013958271922079171, 0.01307289652768112, 0.012283816524773047, 0.01142415080060586, 0.010847677338067071, 0.01018713228903769, 0.009653722257782089, 0.008987070443172917, 0.008558795848455794, 0.008062919934949416, 0.007612357665307055, 0.0072355221493576325, 0.006868159866471876, 0.006615690954442504, 0.0062399379975930655, 0.005909526744409644, 0.005683578175420246]
# testing = [0.06330874566755622, 0.06256487336618506, 0.028209028989264636, 0.021617295380341957, 0.01183992157205849, 0.01430283579197778, 0.0067622409989494805, 0.003744148984469962, 0.0022957805778165397, 0.0013045016739682746, 0.0009151537279344397, 0.0010800441358688163, 0.0008365929423733707, 0.0005190032556666053, 0.0003199395084517831, 0.00024418347031204325, 0.00016334386935979312, 0.00011596587977001538, 0.00010205317206246129, 0.0001247037353798428, 8.485553856287501e-05, 0.00011676668779910574, 0.00010915191711262651, 6.044759742940763e-05, 5.714295269880576e-05, 7.330594217161334e-05, 4.598737075062489e-05, 0.00011170703374867378, 3.912550645637752e-05, 4.584859020256489e-05, 7.500178778988395e-05, 4.867396181217664e-05, 6.683671674565935e-05, 8.663400744613321e-05, 7.716861823021648e-05, 5.589609856203905e-05, 6.782313101026265e-05, 3.7909261919284444e-05, 2.965721682916684e-05, 7.229118064868301e-05, 0.00012999524453754087, 8.655870580119363e-05, 0.00011821497937928546, 4.271366870793258e-05, 5.460962416916967e-05, 2.838415169085973e-05, 4.29279400539814e-05, 6.640062457116577e-05, 5.047266612000886e-05, 3.578657899851447e-05]
# bestPredicted = [0.017705128, 0.019849813, 0.017686708, 0.016733915, 0.019161567, 0.018322844, 0.020389723, 0.017897967, 0.017740453, 0.020094985, 0.021168869, 0.018122684, 0.016922578, 0.018203743, 0.020011205, 0.017741721, 0.018040672, 0.019886818, 0.016917136, 0.01823448, 0.016955107, 0.024222523, 0.018103832, 0.017918311, 0.020417497, 0.018337518, 0.020352017, 0.019732475, 0.019902997, 0.018544804]
# predictedActual =[0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]
# bestPredicted = [0.017705128, 0.019849813, 0.017686708, 0.016733915, 0.019161567, 0.018322844, 0.020389723, 0.017897967, 0.017740453, 0.020094985, 0.021168869, 0.018122684, 0.016922578, 0.018203743, 0.020011205, 0.017741721, 0.018040672, 0.019886818, 0.016917136, 0.01823448, 0.016955107, 0.024222523, 0.018103832, 0.017918311, 0.020417497, 0.018337518, 0.020352017, 0.019732475, 0.019902997, 0.018544804]

#lr=0.000005
# training=[2.824190340140429, 1.4635077196852009, 0.6374613172559227, 0.23811786105721944, 0.12295488432696178, 0.07877211230724954, 0.04662397407871073, 0.028796746339558896, 0.02088786633501145, 0.015751449696555637, 0.012626803620478633, 0.01062395766830777, 0.008962755428183398, 0.007981008606392911, 0.007243416131057141, 0.006675534148213537, 0.006291629372817252, 0.006042392088007874, 0.005856987322911609, 0.005691546045815082, 0.005647213934164432, 0.005561243580566952, 0.005507669453330592, 0.005556763148612794, 0.0054319029097582875, 0.005547756239280534, 0.00547215481528562, 0.005490995889650351, 0.005530991595574526, 0.005653056007401359]
# validation = [2.9416550780847737, 1.596919700581553, 0.8508101411667662, 0.49108459518501507, 0.3407396217094518, 0.2166791167895035, 0.12994010303259423, 0.08758567878969482, 0.06489255496331899, 0.05035207759907916, 0.04076130721678412, 0.03330033822290958, 0.028118871366553493, 0.023513126256362482, 0.020150064349899, 0.017399734963344102, 0.015113386419522278, 0.013175488567357658, 0.011524945923234345, 0.010184687925113733, 0.009036678588366945, 0.008110208743115563, 0.007336619979263995, 0.006567255578038457, 0.0060528985645602745, 0.005479673376715855, 0.005077335729195574, 0.004731524729116908, 0.004428889776692209, 0.004151527938019071]
# testing = [0.04844197971112372, 0.03418549049662944, 0.00883090277086499, 0.0033438913136487262, 0.0013963377950408247, 0.001844762430542009, 0.00078014733866703, 0.00025050172711804034, 0.00010285719162777214, 0.00020772969885823441, 5.811411143214964e-05, 4.881451546668687e-05, 5.328203425170854e-05, 3.430652473834007e-05, 8.749050318591227e-05, 3.4445186685073704e-05, 9.703793146451115e-05, 2.819972374000736e-05, 3.828398610879758e-05, 0.00010782533497863696, 7.601377294545787e-05, 0.00012148792792236545, 9.829848963623684e-05, 6.031427700439553e-05, 3.030678848126186e-05, 0.00010065242997732742, 4.6917358252660134e-05, 0.0001620812430492373, 4.3725179184247896e-05, 4.754940454461562e-05]
# bestPredicted = [0.021221379, 0.014693044, 0.021453405, 0.018553078, 0.015197247, 0.017802013, 0.021899372, 0.018064458, 0.012890544, 0.016366394, 0.023418967, 0.013427217, 0.021733543, 0.02126079, 0.016681839, 0.0199578, 0.021711776, 0.021524126, 0.017594226, 0.015144322, 0.018611176, 0.021629523, 0.016596014, 0.012475867, 0.020041421, 0.018144425, 0.019234281, 0.016783906, 0.014522253, 0.018940225]
# predictedActual =[0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]
# bestPredicted =[0.018687949, 0.021342643, 0.02145975, 0.019837204, 0.02402857, 0.01730386, 0.020530095, 0.029148092, 0.026291924, 0.021928236, 0.027013743, 0.029545685, 0.02157444, 0.026124636, 0.02567418, 0.023179509, 0.029405886, 0.021646848, 0.03058902, 0.026854228, 0.027432933, 0.021021493, 0.030928064, 0.023256049, 0.025593348, 0.019157585, 0.022112807, 0.022970213, 0.025366392, 0.0209946]

#encoding layer=1
training=[2.373680343265156, 0.9745084811725442, 0.3439931860398168, 0.13871592787012227, 0.06951552107107034, 0.027414019572200053, 0.013081118829079245, 0.008454000256629344, 0.00666046561502151, 0.00549202820442521, 0.0439, 0.0038533356749248693, 0.0036540265362644546, 0.0034973789132107897, 0.0033523369889837634, 0.003233037455374578, 0.003115466954036521, 0.0030519609411223747, 0.002953160703780054, 0.0028376416195443335, 0.00281981943078163, 0.002803936683864393, 0.0027654501857220528, 0.0027306374553618036, 0.00270573875136864, 0.0027421974245846552]
validation=[2.5198813263739686, 1.1098361362052798, 0.5287921522446686, 0.2904042970148372, 0.14265367029407094, 0.06945471641909086, 0.041896895366676304, 0.027509672471029832, 0.01951421645329895, 0.014111214489813614, 0.010648878486618938, 0.008183506905605514, 0.006538346764524877, 0.005378865972620042, 0.004570494907232098, 0.003988904779485622, 0.003578772089891119, 0.0032851800819135037, 0.0030292347572540143, 0.0028740981249352378, 0.0027484783289109466, 0.002639804884064341, 0.002557901735211998, 0.002465428540157542, 0.0024056214863977287, 0.002327152382231766, 0.0023080890132465334, 0.0022775963917565233, 0.002220622248152395, 0.002198796043498508, 0.0021894486507642095, 0.0021698314293262227, 0.002166446318546725, 0.002143154951675458, 0.002138133814698403]
testing=[0.04402554006908182, 0.02425590605639459, 0.006024873910797287, 0.0023442016855814, 0.002838696094713314, 0.0011217056414625376, 0.0002801940931164307, 0.00011985845605721999, 3.923680506020661e-05, 7.63697568116124e-05, 8.623368585690575e-05, 7.57288658253546e-05, 5.658830619380697e-05, 7.02603186395114e-05, 5.380754548111626e-05, 5.551684351371266e-05, 5.899698016847577e-05, 5.777518778712754e-05, 0.00011047878915035384, 8.186854141662846e-05, 6.850709158236283e-05, 5.8956698032601436e-05, 5.3999730896470153e-05, 5.850383820484643e-05, 8.887229407689437e-05, 7.13269210364935e-05, 6.920410554651143e-05, 7.201831779503503e-05, 4.710776388689192e-05, 3.728545033218647e-05, 5.152608357602841e-05, 4.008744907321017e-05, 4.644116736004999e-05, 4.794210395031104e-05, 5.6454355150195824e-05]
bestPredicted=[0.01841704, 0.01955321, 0.0175063, 0.019793289, 0.019534647, 0.018575296, 0.018673407, 0.020350637, 0.01884897, 0.019393165, 0.019722436, 0.02185185, 0.019014709, 0.021097599, 0.021107538, 0.020890564, 0.021463547, 0.018054483, 0.020650027, 0.020829776, 0.021642426, 0.0201298, 0.01991602, 0.019406501, 0.019716077, 0.018447183, 0.018861374, 0.021315444, 0.020738827, 0.020214371]
bestActual=[0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]
bestPredicted=[0.020328231, 0.022278054, 0.018785382, 0.020809319, 0.022052426, 0.02177941, 0.022705732, 0.022078097, 0.021758683, 0.022824707, 0.023215098, 0.022757318, 0.019918997, 0.021155423, 0.019777304, 0.021771116, 0.023079023, 0.021342166, 0.020473944, 0.020723578, 0.020234765, 0.021000713, 0.02154802, 0.02092567, 0.021332657, 0.02165579, 0.022275845, 0.022792507, 0.021395417, 0.021036431]

# 50 best epoch= epochs patience = 5 encoding layers=3
# training =[3.128537430874669, 0.1500761538572886, 0.06155500453135752, 0.03172088674762755, 0.021109430674358165, 0.013211967180740714, 0.007263575876035163, 0.005720603879986593, 0.005143256554107947, 0.004883216152819997, 0.004630403689311303, 0.004502132546775965, 0.004244018646017337, 0.003946584959069716, 0.003700724887516202, 0.003528586819424144, 0.0032888864407121564, 0.003120010242112524, 0.002942308449298749, 0.002829898339400869, 0.002718956042053315, 0.0026898665167838518, 0.0026129480098979955, 0.002651168090876051, 0.002661024033767038, 0.0026737430300155323]
# validation =[2.1348774749481225, 0.30492929816480646, 0.12009138933233922, 0.06582714252376114, 0.03857479372277827, 0.024424880353125306, 0.01656086469018291, 0.012679280929866782, 0.010135018616594393, 0.008244839575079385, 0.0068709560567351115, 0.005885413273607438, 0.005055447347669696, 0.004467099890176278, 0.004065555402735903, 0.003726469940355589, 0.003443366177518687, 0.003232414771219407, 0.0030425724756575003, 0.0029047212194186892, 0.002803043293397252, 0.002728677092595977, 0.002655072367301589, 0.002594771375323666, 0.0025490546852197597, 0.002506003236115363]
# testing = [0.004091486531193318, 0.0003821593464100247, 0.00045956789905816177, 0.00012368997070850656, 0.00012089274152304674, 0.00010941117514717817, 7.846598052334881e-05, 3.858873682647984e-05, 7.287614547713046e-05, 4.6075640280267494e-05, 6.445891993770227e-05, 3.340123695797739e-05, 3.6182570231429804e-05, 2.9292525023152205e-05, 2.7950888265869945e-05, 3.484825214915904e-05, 2.2318819891012035e-05, 2.7494771579552076e-05, 2.245434271807438e-05, 2.3653403897190526e-05, 3.2792053171918956e-05, 3.036511257278992e-05, 2.39579861518931e-05, 7.92309519861373e-05, 6.873645135615848e-05, 8.958320957791652e-05]
# bestPredicted = [0.022759037, 0.0202126, 0.020693682, 0.019956425, 0.015882488, 0.02217398, 0.020733606, 0.014351765, 0.014125341, 0.017940128, 0.013505971, 0.015467393, 0.016118761, 0.014121766, 0.015945133, 0.016906034, 0.016914047, 0.02176132, 0.016372792, 0.01691915, 0.01360915, 0.02128821, 0.014629925, 0.016020905, 0.017917534, 0.017092708, 0.017189357, 0.015029305, 0.0150507875, 0.020017263]
# predictedActual = [0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]

# encoding layers=8
# validation=[3.128537430874669, 0.1500761538572886, 0.06155500453135752, 0.03172088674762755, 0.021109430674358165, 0.013211967180740714, 0.007263575876035163, 0.005720603879986593, 0.005143256554107947, 0.004883216152819997, 0.004630403689311303, 0.004502132546775965, 0.004244018646017337, 0.003946584959069716, 0.003700724887516202, 0.003528586819424144, 0.0032888864407121564, 0.003120010242112524, 0.002942308449298749, 0.002829898339400869, 0.002718956042053315, 0.0026898665167838518, 0.0026129480098979955, 0.002651168090876051, 0.002661024033767038, 0.0026737430300155323, 0.0026511053271277537, 0.002620373373094387, 0.002613412673416552, 0.002628005934744986, 0.002596196290830862, 0.0026351488305466227, 0.0026698488565537535, 0.0026338312630173823, 0.0026488600191139438, 0.0026519106337451795, 0.0026579685266437426, 0.0026931724160003724]
# training =[2.1348774749481225, 0.30492929816480646, 0.12009138933233922, 0.06582714252376114, 0.03857479372277827, 0.024424880353125306, 0.01656086469018291, 0.012679280929866782, 0.010135018616594393, 0.008244839575079385, 0.0068709560567351115, 0.005885413273607438, 0.005055447347669696, 0.004467099890176278, 0.004065555402735903, 0.003726469940355589, 0.003443366177518687, 0.003232414771219407, 0.0030425724756575003, 0.0029047212194186892, 0.002803043293397252, 0.002728677092595977, 0.002655072367301589, 0.002594771375323666, 0.0025490546852197597, 0.002506003236115363, 0.0024839906148824207, 0.002461399967314688, 0.0024529874760129745]
# testing = [0.004091486531193318, 0.0003821593464100247, 0.00045956789905816177, 0.00012368997070850656, 0.00012089274152304674, 0.00010941117514717817, 7.846598052334881e-05, 3.858873682647984e-05, 7.287614547713046e-05, 4.6075640280267494e-05, 6.445891993770227e-05, 3.340123695797739e-05, 3.6182570231429804e-05, 2.9292525023152205e-05, 2.7950888265869945e-05, 3.484825214915904e-05, 2.2318819891012035e-05, 2.7494771579552076e-05, 2.245434271807438e-05, 2.3653403897190526e-05, 3.2792053171918956e-05, 3.036511257278992e-05, 2.39579861518931e-05, 7.92309519861373e-05, 6.873645135615848e-05, 8.958320957791652e-05, 8.664182527706435e-05, 7.272023027275142e-05, 4.612121215774431e-05, 6.537290723738694e-05, 5.495517097359744e-05, 4.7791384337883713e-05, 3.609563552819724e-05, 0.00010072642116208266, 7.568411517721815e-05, 8.87123973903295e-05, 5.570523883746959e-05, 5.268943922065018e-05]
# bestPredicted = [0.022759037, 0.0202126, 0.020693682, 0.019956425, 0.015882488, 0.02217398, 0.020733606, 0.014351765, 0.014125341, 0.017940128, 0.013505971, 0.015467393, 0.016118761, 0.014121766, 0.015945133, 0.016906034, 0.016914047, 0.02176132, 0.016372792, 0.01691915, 0.01360915, 0.02128821, 0.014629925, 0.016020905, 0.017917534, 0.017092708, 0.017189357, 0.015029305, 0.0150507875, 0.020017263]
# predictedActual =[0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]

# encoding layers=10
# validation=[18.842715298266675, 0.18638905629119037, 0.05956030537871047, 0.03024233119860267, 0.01833919680310882, 0.012113722748643222, 0.008557058326399735, 0.006313403821681546, 0.005079561540917957, 0.004534371643323704, 0.0048530023610884555, 0.004467180641819801, 0.003853959117200556, 0.003772418571751727, 0.0038238046935891445, 0.003914731683364816, 0.004028249364672075, 0.003420222715639807, 0.0036273005420071427, 0.0039157599302645325, 0.0038654348281590076, 0.0036636713503750778, 0.003691812772590786, 0.0035076872619868695, 0.0035562575469749126, 0.0034843971198467044, 0.003518125034125188, 0.003582327216363361, 0.0033759545280798837, 0.003207692985914926, 0.003016991105818975, 0.003058951414921004, 0.0030719251413852348, 0.003007625917285064, 0.0030035550555677273, 0.0029635701656537602, 0.0028808886509703218, 0.0029379052705679164, 0.002910612836477006, 0.0028907599365815217, 0.0028718006552557684, 0.002879649806622964, 0.0028945903566634807, 0.0028941114028039425, 0.002898717222080516]
# training =[2.0743025728346507, 0.19333326431405493, 0.07818377030515379, 0.04649213246026697, 0.03088536844607669, 0.022297954858406542, 0.017065068489156496, 0.013206617425317787, 0.010522951251764478, 0.008415107948513257, 0.006523192067430751, 0.004944055747389649, 0.0042125142214184804, 0.0037308720546108576, 0.0034161466939106955, 0.0031836221916688692, 0.003050903039672114, 0.003249925585373709, 0.003017325055320828, 0.002806925796759656, 0.0027238553227861085, 0.0027001256132375842, 0.002644825545351529, 0.002575028575216941, 0.0025844612057292285, 0.0025195487766717225, 0.0025140177831650735, 0.0024727007908758856, 0.002470075400914833, 0.002468738147288416, 0.0024574416422442663, 0.0024191677421537736, 0.002405475372668023, 0.0023945642529053348, 0.002396695016505684, 0.0023821574265086624, 0.0023727398752325123, 0.0023683867458681985, 0.0023597274257419077, 0.0023530330503579596, 0.0023492802056577977, 0.0023397448274978597, 0.0023374856001604737, 0.0023542943980818885, 0.0023396565437622447]
# testing = [0.0027577012319821795, 0.002015205870589045, 0.00114941947816174, 0.0004519514551660763, 0.0003744788935720575, 0.00024017038035209243, 0.00023761667887280743, 0.00013337579997564598, 0.00011545436554649358, 0.00010459447993853883, 8.200312169846075e-05, 8.513785273615452e-05, 0.00010171006726643759, 8.271870741016117e-05, 4.980976411536069e-05, 4.463454618092808e-05, 5.172836165344723e-05, 5.4875441837975806e-05, 4.81646981472486e-05, 3.930269193988066e-05, 2.5315432965602817e-05, 4.8174638162074105e-05, 3.518213476077935e-05, 8.634106217548958e-05, 5.617674094702019e-05, 6.526829299223052e-05, 6.0894256463826226e-05, 3.606884424830171e-05, 4.403289804881896e-05, 5.6300168182487136e-05, 6.135144573745877e-05, 7.723052733532476e-05, 5.2315628114240595e-05, 8.757362263952946e-05, 6.748401363968192e-05, 6.437042563006617e-05, 6.612725828498528e-05, 6.727414642542442e-05, 9.441724820249335e-05, 8.41966628329032e-05, 9.801214101192628e-05, 5.7760823137910524e-05, 0.00010458906362634295, 8.521140276416342e-05, 9.98451605081695e-05]
# bestPredicted = [0.020164842, 0.017342284, 0.02215489, 0.018844489, 0.015540713, 0.020502005, 0.021821989, 0.012352994, 0.0177179, 0.018795751, 0.018314406, 0.013185529, 0.017912902, 0.015205441, 0.016775971, 0.01693924, 0.016818972, 0.024457835, 0.015403591, 0.016299404, 0.01304554, 0.0241937, 0.015491575, 0.017862674, 0.019491322, 0.020166364, 0.016624128, 0.019113652, 0.015286537, 0.020968499]
# predictedActual =[0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]


# #Patience=7 LR=0.00001, sliding window
# validation=[2.3973559770799975, 0.26113733415214646, 0.06829019285824303, 0.03571009331044323, 0.021431175398238567, 0.014625941629278284, 0.009473072719434667, 0.007370060665806654, 0.006562839272360719, 0.006358896167112832, 0.006443672583459008, 0.006522704255061591, 0.006673937612438691, 0.006825449297734424, 0.006739931274122137, 0.006552401738015921, 0.006375396552172371, 0.0059505900306780464, 0.00540315667288457, 0.005094669234289058, 0.004694403972004103, 0.004217555678158748, 0.003903710399901959, 0.0036293077654305484, 0.003352523213340362, 0.00315772438840585, 0.0030054301425773734, 0.002935409053897491, 0.0028735785054707684, 0.002869990597821082, 0.00287311691924952, 0.0030156306891548673, 0.0030755377532863193, 0.0031164327473017887]
# training=[2.3351784296069016, 0.517074089205181, 0.17262988233616783, 0.08633483014330502, 0.053577500077494886, 0.035431178032439704, 0.024052191973763157, 0.017381169798016304, 0.013166496038259813, 0.010368408658370668, 0.00835238010405755, 0.0068560050905912984, 0.005824712980313771, 0.005051635606862727, 0.004401895885497445, 0.003976033304882457, 0.003632074700962102, 0.003369191858278159, 0.0031701829154140923, 0.0030161299220504024, 0.002871950704284049, 0.0027779318760741993, 0.002707492584013031, 0.0026350573408705255, 0.002572751718893227, 0.00253373321872797, 0.002491003670338678, 0.0024572652076037217, 0.0024264405670672575, 0.0024111109011178333, 0.0023776021540264066, 0.0023514866930478564, 0.002321727872056044, 0.0022931554316980443]
# testing=[0.023904928252059546, 0.0023373462144851472, 0.0004946741506425486, 0.00027871847713967126, 0.0002646901155745895, 0.00017275723204400844, 0.00016972424215700336, 7.376902161772012e-05, 0.00010071277808111944, 9.907519388274196e-05, 9.414732759340469e-05, 3.1674123939781136e-05, 5.781723347148474e-05, 4.9476834184795396e-05, 2.5400839925231804e-05, 4.5904020430529935e-05, 4.3536035887288046e-05, 2.46033640731722e-05, 7.162400121291321e-05, 4.497865495339008e-05, 5.13243355742166e-05, 6.22622106288419e-05, 4.923942233688102e-05, 6.751172903272056e-05, 3.29568674236916e-05, 4.075703032028045e-05, 3.115012735601994e-05, 3.2098423903712645e-05, 3.8704800813445295e-05, 3.4132116587181374e-05, 3.531512242820541e-05, 2.5133065041873053e-05, 2.5667730600253727e-05, 2.338559120869215e-05]
# bestPredicted=[0.017136188, 0.01927562, 0.017140217, 0.018727494, 0.018486112, 0.018291077, 0.018657302, 0.01941251, 0.019793388, 0.019047052, 0.018264657, 0.018319625, 0.017076433, 0.018876564, 0.018192438, 0.018743064, 0.018252369, 0.018954318, 0.01963323, 0.018428925, 0.018755741, 0.018151332, 0.018294238, 0.017928243, 0.018522684, 0.01835328, 0.018480398, 0.018255062, 0.018474601, 0.017861186]
# bestActual=[0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]

# Patience=5
# validation=[2.3973559770799975, 0.26113733415214646, 0.06829019285824303, 0.03571009331044323, 0.021431175398238567, 0.014625941629278284, 0.009473072719434667, 0.007370060665806654, 0.006562839272360719, 0.006358896167112832, 0.006443672583459008, 0.006522704255061591, 0.006673937612438691, 0.006825449297734424]
# training=[2.3351784296069016, 0.517074089205181, 0.17262988233616783, 0.08633483014330502, 0.053577500077494886, 0.035431178032439704, 0.024052191973763157, 0.017381169798016304, 0.013166496038259813, 0.010368408658370668, 0.00835238010405755, 0.0068560050905912984, 0.005824712980313771, 0.005051635606862727]
# testing=[0.023904928252059546, 0.0023373462144851472, 0.0004946741506425486, 0.00027871847713967126, 0.0002646901155745895, 0.00017275723204400844, 0.00016972424215700336, 7.376902161772012e-05, 0.00010071277808111944, 9.907519388274196e-05, 9.414732759340469e-05, 3.1674123939781136e-05, 5.781723347148474e-05, 4.9476834184795396e-05]
# bestPredicted=[0.015874788, 0.021403875, 0.015465083, 0.017039996, 0.02062773, 0.021738537, 0.021936199, 0.026109956, 0.014802866, 0.016227763, 0.01596637, 0.020669842, 0.018464435, 0.022995895, 0.017426636, 0.017899398, 0.018546993, 0.020414345, 0.016636921, 0.020271514, 0.017138492, 0.017450511, 0.019779125, 0.020836148, 0.018534308, 0.01698191, 0.015613934, 0.019518116, 0.016924175, 0.018615512]
# bestActual=[0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]
# bestPredicted=[0.01737351, 0.03233496, 0.010991922, 0.013767727, 0.01612926, 0.01687644, 0.033324666, 0.021572195, 0.021744743, 0.018523445, 0.015966149, 0.017849002, 0.007682468, 0.02780048, 0.027989626, 0.020619594, 0.020024829, 0.025054595, 0.016302226, 0.028181948, 0.00923188, 0.021459308, 0.018924246, 0.013898663, 0.016758233, 0.020443592, 0.013307994, 0.026001336, 0.022080425, 0.029336834]

#Patience=3
# validation=[2.3973558311728906, 0.261137279802013, 0.06829017342300794, 0.03571009957776132, 0.021431181062276473, 0.014626075540468788, 0.009473747005371121, 0.007372652496677697, 0.006563189497484477, 0.006353471809404275, 0.006401814617171787, 0.006441296935865871, 0.006616041399983873]
# training=[2.3351783947369777, 0.517074069082804, 0.17262988644996305, 0.08633484112087361, 0.05357752070568244, 0.03543114830357296, 0.024052353998090893, 0.01738135730443431, 0.01317629482859514, 0.01037521707553884, 0.008360074999323121, 0.006854389233390798, 0.005822125897489484]
# testing=[0.02390492200144486, 0.0023373470650868635, 0.0004946743811691444, 0.0002787217802534133, 0.0002646726235357137, 0.00017273792278909948, 0.0001696601753471791, 7.388350104993068e-05, 0.00010361741651232616, 9.947163076961732e-05, 9.370395502962203e-05, 3.2101802553183445e-05, 5.991818217210368e-05]
# bestPredicted=[0.01667979, 0.023160968, 0.016563866, 0.017668324, 0.021016605, 0.02110725, 0.022957556, 0.02536041, 0.015553, 0.01659032, 0.016562534, 0.021366922, 0.018500475, 0.023216093, 0.018277176, 0.018038873, 0.01823314, 0.020205399, 0.018082764, 0.020543681, 0.01665634, 0.01838918, 0.020558268, 0.020509247, 0.01842142, 0.017324416, 0.01619134, 0.019999823, 0.016980525, 0.019254502]
# bestActual=[0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]
# bestPredicted=[0.018306147, 0.029924592, 0.014797859, 0.02135312, 0.02080424, 0.028296968, 0.035506435, 0.024812713, 0.025042575, 0.02317746, 0.01919812, 0.02368668, 0.02604631, 0.03068794, 0.01871119, 0.023333298, 0.021694675, 0.028044842, 0.022062697, 0.022902649, 0.020360034, 0.02802466, 0.030133966, 0.021817299, 0.030985167, 0.019250212, 0.02036934, 0.024006225, 0.023408324, 0.021679487]

#Patience=1

# 29 best epoch patience=10
# validation=[2.3973559770799975, 0.26113733415214646, 0.06829019285824303, 0.03571009331044323, 0.021431175398238567, 0.014625941629278284, 0.009473072719434667, 0.007370060665806654, 0.006562839272360719, 0.006358896167112832, 0.006443672583459008, 0.006522704255061591, 0.006673937612438691, 0.006825449297734424, 0.006739931274122137, 0.006552401738015921, 0.006375396552172371, 0.0059505900306780464, 0.00540315667288457, 0.005094669234289058, 0.004694403972004103, 0.004217555678158748, 0.003903710399901959, 0.0036293077654305484, 0.003352523213340362, 0.00315772438840585, 0.0030054301425773734, 0.002935409053897491, 0.0028735785054707684, 0.002869990597821082, 0.00287311691924952, 0.0030156306891548673, 0.0030755377532863193, 0.0031164327473017887, 0.0031263562781121876, 0.0032608129622455164]
# training =[2.3351784296069016, 0.517074089205181, 0.17262988233616783, 0.08633483014330502, 0.053577500077494886, 0.035431178032439704, 0.024052191973763157, 0.017381169798016304, 0.013166496038259813, 0.010368408658370668, 0.00835238010405755, 0.0068560050905912984, 0.005824712980313771, 0.005051635606862727, 0.004401895885497445, 0.003976033304882457, 0.003632074700962102, 0.003369191858278159, 0.0031701829154140923, 0.0030161299220504024, 0.002871950704284049, 0.0027779318760741993, 0.002707492584013031, 0.0026350573408705255, 0.002572751718893227, 0.00253373321872797, 0.002491003670338678, 0.0024572652076037217, 0.0024264405670672575, 0.0024111109011178333, 0.0023776021540264066, 0.0023514866930478564, 0.002321727872056044, 0.0022931554316980443, 0.00227478938530934, 0.0022475118438265345]
# testing = [0.023904928252059546, 0.0023373462144851472, 0.0004946741506425486, 0.00027871847713967126, 0.0002646901155745895, 0.00017275723204400844, 0.00016972424215700336, 7.376902161772012e-05, 0.00010071277808111944, 9.907519388274196e-05, 9.414732759340469e-05, 3.1674123939781136e-05, 5.781723347148474e-05, 4.9476834184795396e-05, 2.5400839925231804e-05, 4.5904020430529935e-05, 4.3536035887288046e-05, 2.46033640731722e-05, 7.162400121291321e-05, 4.497865495339008e-05, 5.13243355742166e-05, 6.22622106288419e-05, 4.923942233688102e-05, 6.751172903272056e-05, 3.29568674236916e-05, 4.075703032028045e-05, 3.115012735601994e-05, 3.2098423903712645e-05, 3.8704800813445295e-05, 3.4132116587181374e-05, 3.531512242820541e-05, 2.5133065041873053e-05, 2.5667730600253727e-05, 2.338559120869215e-05, 2.8056346590239927e-05, 2.94709585284545e-05]
# bestPredicted = [0.017136188, 0.01927562, 0.017140217, 0.018727494, 0.018486112, 0.018291077, 0.018657302, 0.01941251, 0.019793388, 0.019047052, 0.018264657, 0.018319625, 0.017076433, 0.018876564, 0.018192438, 0.018743064, 0.018252369, 0.018954318, 0.01963323, 0.018428925, 0.018755741, 0.018151332, 0.018294238, 0.017928243, 0.018522684, 0.01835328, 0.018480398, 0.018255062, 0.018474601, 0.017861186]
# predictedActual = [0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]

# # No sliding window 
# validation=[10.308899205172525, 5.166247250032636, 2.048747572955089, 1.4034983016379754, 0.5343802668476109, 0.24682439970241024, 0.12387851436251288, 0.06854978754774702, 0.04203803426798654, 0.027946417138371395, 0.013521314709760068, 0.009037355910731548, 0.006374456615420368, 0.004979807877754309, 0.004634518830108894, 0.004143742442763471, 0.004078119280609967, 0.0037536290461456664, 0.0035074529878127768, 0.003201509182674344, 0.0035692637934701763, 0.0037341623691818605, 0.003205173007971473, 0.0033293690047779003, 0.0032408852714578763, 0.003232882706313083, 0.002955537817186843, 0.003114533682660038, 0.0032085831005756, 0.0028913894261387374, 0.002599830627964692, 0.00254398446512908, 0.0024368000274888825, 0.002416131655221425, 0.0022241850833674584, 0.002367520409669444, 0.002550895387023955, 0.0020505798354813164, 0.002155503063709592, 0.0021976524787626884, 0.0018861007412879051, 0.002181728881639409, 0.0017659800343967074, 0.001840994094696403, 0.001954632779536227, 0.001920329594112114, 0.0023106477836293184]
# training=[4.247666940771473, 2.5199982823899636, 1.742005159226576, 1.2050785863619387, 0.8366123963649268, 0.5930154535189182, 0.42675503847545826, 0.3121727751642202, 0.23306288112733137, 0.1763949723293177, 0.13466144157598742, 0.10405508033556751, 0.08464760464388701, 0.06851447752631333, 0.056030382173580896, 0.04703271597358416, 0.039218711569129434, 0.03344764788916357, 0.028357631126941514, 0.024345452638334215, 0.020718257939981326, 0.017984804147350902, 0.015740083044148888, 0.013423472437132216, 0.011639335622010057, 0.01010815533777834, 0.008765063298432067, 0.007619591996121933, 0.0066958263191871925, 0.006030317401516999, 0.005366818970622534, 0.0048848516335262635, 0.004421448584617781, 0.00414531979329519, 0.0038514802400315368, 0.003644138129767183, 0.0034568898459574437, 0.003267414674040101, 0.0031390931847566188, 0.003036784337359056, 0.002937266295394619, 0.0028452476826587593, 0.0027415287933130602, 0.0026827885818916436, 0.002585219383902771, 0.002463632751161669, 0.0023982473467516895]
# testing=[1.0569014426762153, 0.5450604610872714, 0.2188580739681538, 0.20664323249354793, 0.09527743285842262, 0.05656806569372087, 0.02969694624951339, 0.018667680432074084, 0.011204026738062822, 0.00993572965237128, 0.008695143656439797, 0.008155083887253074, 0.007392362115647359, 0.005777441059484297, 0.007535468898672788, 0.006380542880071683, 0.006512620108964777, 0.00706119231574724, 0.00785727945981464, 0.005795750920588438, 0.006403283516345386, 0.0064595528994797575, 0.005438778592540493, 0.0052748628449816055, 0.0043164932402523564, 0.004015113212446238, 0.0035988943436587135, 0.003671883569693657, 0.0037873994104846167, 0.003328227093692484, 0.0029365872763761733, 0.0028710076543399703, 0.00284457497993545, 0.0028126107437109037, 0.0024518638058048797, 0.0028158143147786556, 0.003015132552391867, 0.0024213194908892476, 0.0023953280541843037, 0.002720653581693506, 0.0021412276420450472, 0.0025951595822458415, 0.002048933387828476, 0.002067797232777513, 0.0023154091761430308, 0.0022935755730583004, 0.0027633598845900422]
# bestPredicted=[0.02068364, 0.022105524, 0.02139765, 0.021544911, 0.021445537, 0.022552475, 0.02218361, 0.022303393, 0.021918759, 0.021578027, 0.022435296, 0.023638908, 0.022349339, 0.022843253, 0.023626683, 0.023758482, 0.023629747, 0.022988793, 0.024140801, 0.023513557, 0.02326814, 0.023974068, 0.02354502, 0.023474786, 0.022543443, 0.023204098, 0.023345921, 0.023654787, 0.023271427, 0.023719365]
# bestActual=[0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]

# # Sliding window Naive validation Patience=3
# validation=[19.571631570198406, 16.165676587419327, 11.915465000794043, 17.405445413280052, 11.245976089700598, 5.1779610016858975, 7.619933539632249, 6.1190414660733685, 6.789663032446894, 5.730329819243156, 5.229060574895946, 4.9894666978968925, 2.6272913626532066, 5.04465365061066, 4.515915043859178, 3.7237819415781175, 2.2796860713763767, 1.5994050250945369, 2.3256279578597097, 1.6622910841623144, 1.4137109621261954, 1.4281301541168878, 0.8482632034269726, 0.8019996490951308, 0.6820709912575702, 0.7693821597258274, 0.4734460036996885, 0.5283037145415194, 0.3569749042287761, 0.35916868745561403, 0.2768503519677009, 0.318389818795213, 0.24180436259857968, 0.24783549591203685, 0.14683064299898993, 0.1787775423178985, 0.15059016088504312, 0.14630998572692874, 0.11571782750319125, 0.11853613758140387, 0.09980291416510317, 0.06826569863152035, 0.08523758336315905, 0.06305570525030837, 0.04213885355920599, 0.05848733022826837, 0.04379462939627182, 0.03815287332461447, 0.03837559071180884, 0.04420034164003857]
# training=[5.149449642501948, 4.655602880732687, 4.0510603320770215, 3.5601891197406372, 3.121146547862188, 2.774044997882875, 2.5280730998112997, 2.33581288187329, 2.2025977052650925, 2.008915999840046, 1.92582199970216, 1.8036205686371902, 1.6738275458352159, 1.5756978334133787, 1.4778079456575826, 1.3631783211793953, 1.276709608621409, 1.1752679436590745, 1.0843352201913248, 1.0126177995628762, 0.9330318413891838, 0.8783495072580956, 0.819072563431915, 0.7703362085925404, 0.7272822613455916, 0.6779543528957513, 0.6361582514670608, 0.5968679044012805, 0.5575661325598386, 0.5278285000689021, 0.49186545069655885, 0.4694221719755231, 0.4406544775080034, 0.4108676409138698, 0.3885687621971976, 0.37091049806386045, 0.3468199700546137, 0.32667299916523135, 0.31063308786060806, 0.29031511322087894, 0.2800637669175374, 0.26594294374668365, 0.24998771837015474, 0.23630335628687038, 0.22237571378515683, 0.2097700074798972, 0.1992636355102202, 0.19277147900351801, 0.17796343754556693, 0.17161345761238153]
# testing=[1.7658179166475994, 1.2525386506262846, 0.9074389501545842, 1.5228990773227697, 0.8995008889209974, 0.4868208805096569, 0.7289323957809637, 0.6106350723159828, 0.6502649406457061, 0.5594262978726126, 0.4808143039578414, 0.48638142414406027, 0.22251124558740984, 0.4198654142177214, 0.3460201730449028, 0.31360066276691456, 0.1857626137553221, 0.1297054172993923, 0.20260086036090919, 0.1720409467998656, 0.16098608112823695, 
# 0.15593066090362706, 0.09590656220969411, 0.09091312616130195, 0.09274861561191106, 0.09540612603156878, 0.06647298637087756, 0.08391868831631573, 0.05362169489355528, 0.0531837457761775, 0.04554861328355894, 0.050485861020780946, 0.03999239598027621, 0.041035040549317954, 0.029356147918625806, 0.03094179089476248, 0.02543006491820217, 0.02732495559300251, 0.021387514568888027, 0.0257416899299519, 0.02086279726079733, 0.017710684020704307, 0.01853697454189455, 0.01551511653647462, 0.013094419216326971, 0.015627429440114277, 0.012788993731572515, 0.013910057111366805, 0.01203972183562757, 0.014491609196041949]
# bestPredicted=[0.012677768, 0.031091005, 0.014057532, 0.045437362, 0.030851137, 0.030848343, 0.046036493, 0.006851038, 0.046018757, 0.0066709807, 0.03233696, 0.017932657, -0.029853001, 0.020383107, 0.00937165, 0.027746165, 0.009146947, 0.041255377, -0.020987112, 0.04160779, 0.011388017, -0.019103076, 0.0063564386, 0.02522174, 0.018664958, 0.026073173, 0.008935161, 0.007517324, 0.00079184026, -0.00487053]
# bestActual=[0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]

# # Patience=5
# validation=[2.3973558311728906, 0.261137279802013, 0.06829017342300794, 0.03571009957776132, 0.021431181062276473, 0.014626075540468788, 0.009473747005371121, 0.007372652496677697, 0.006563189497484477, 0.006353471809404275, 0.006401814617171787, 0.006441296935865871, 0.006616041399983873, 0.006796034225076952]
# training=[2.3351783947369777, 0.517074069082804, 0.17262988644996305, 0.08633484112087361, 0.05357752070568244, 0.03543114830357296, 0.024052353998090893, 0.01738135730443431, 0.01317629482859514, 0.01037521707553884, 0.008360074999323121, 0.006854389233390798, 0.005822125897489484, 0.005081585062986687]
# testing=[0.02390492200144486, 0.0023373470650868635, 0.0004946743811691444, 0.0002787217802534133, 0.0002646726235357137, 0.00017273792278909948, 0.0001696601753471791, 7.388350104993068e-05, 0.00010361741651232616, 9.947163076961732e-05, 9.370395502962203e-05, 3.2101802553183445e-05, 5.991818217210368e-05, 5.071098067322594e-05]
# bestPredicted=[0.01667979, 0.023160968, 0.016563866, 0.017668324, 0.021016605, 0.02110725, 0.022957556, 0.02536041, 0.015553, 0.01659032, 0.016562534, 0.021366922, 0.018500475, 0.023216093, 0.018277176, 0.018038873, 0.01823314, 0.020205399, 0.018082764, 0.020543681, 0.01665634, 0.01838918, 0.020558268, 0.020509247, 0.01842142, 0.017324416, 0.01619134, 0.019999823, 0.016980525, 0.019254502]
# bestActual=[0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]
# bestPredicted=[0.017440975, 0.03238355, 0.01113607, 0.0137601225, 0.016012646, 0.016779307, 0.03326256, 0.021764021, 0.02216194, 0.01851055, 0.016034603, 0.018158797, 0.007944828, 0.028142376, 0.027859123, 0.020734815, 0.020229876, 0.025014667, 0.016353466, 0.02825063, 0.009154545, 0.021311926, 0.019060673, 0.013869727, 0.016897297, 0.020425068, 0.013201381, 0.026138492, 0.022232853, 0.029375687]

# # Patience=10
# validation=[19.571631570198406, 16.165676587419327, 11.915465000794043, 17.405445413280052, 11.245976089700598, 5.1779610016858975, 7.619933539632249, 6.1190414660733685, 6.789663032446894, 5.730329819243156, 5.229060574895946, 4.9894666978968925, 2.6272913626532066, 5.04465365061066, 4.515915043859178, 3.7237819415781175, 2.2796860713763767, 1.5994050250945369, 2.3256279578597097, 1.6622910841623144, 1.4137109621261954, 1.4281301541168878, 0.8482632034269726, 0.8019996490951308, 0.6820709912575702, 0.7693821597258274, 0.4734460036996885, 0.5283037145415194, 0.3569749042287761, 0.35916868745561403, 0.2768503519677009, 0.318389818795213, 0.24180436259857968, 0.24783549591203685, 0.14683064299898993, 0.1787775423178985, 0.15059016088504312, 0.14630998572692874, 0.11571782750319125, 0.11853613758140387, 0.09980291416510317, 0.06826569863152035, 0.08523758336315905, 0.06305570525030837, 0.04213885355920599, 0.05848733022826837, 0.04379462939627182, 0.03815287332461447, 0.03837559071180884, 0.04420034164003857, 0.038879431405194904, 0.03636037882806025, 0.030675102363727745, 0.028074148594363135, 0.024215282033219352, 0.024094033287559935, 0.02225483171790642, 0.02257561548899907, 0.017828231914726843, 0.012316601717236465, 0.017665617750768574, 0.01712366597468151, 0.011811177452778645, 0.013013820511073358, 0.013867405128044444, 0.00790086596327045, 0.010033384038666954, 0.011261691542826418, 0.009688043681034339, 0.007873411770550946, 0.006735609768534619, 0.009031969852944972, 0.00964038531273869, 0.007789200529757225, 0.0075605067832162295, 0.008358512071998664, 0.00649394103294988, 0.0070821960961621215, 0.006136671599045173, 0.005695045728892959, 0.006293440041118655, 0.006050382550159082, 0.00467388607265553, 0.005438453217616491, 0.005675853009482668, 0.0051018334828237975, 0.005170757097363767, 0.0049342118628189265, 0.003815963861071886, 0.004442389930000296, 0.004032508294496916, 0.00445045530223612, 0.004333587604936351, 0.004387316755135072, 0.0037405213374157144, 0.0039712347750701215, 0.004002004416865058, 0.003813278158173511, 0.004129653687852475, 0.0036423648908011836, 0.0038284393993627784, 0.0036481098984003377, 0.0037621305542663223, 0.003804081339210782, 0.00357328136822631, 0.003482450275666095, 0.003256918725616618, 0.0036990884752511294, 0.0035079120026532446, 0.0036854603073448126, 0.00334531852744443, 0.0035734286472684238, 0.0033839803714274907, 0.0034303445990390845, 0.0033366362118310506, 0.0032310257844943347, 0.003176365020683377, 0.0032488023592426854, 0.003438292017436219, 0.0035125899291110502, 0.003220304116673516, 0.0032760198376253795, 0.0034425832863824776, 0.0032918086390683983, 0.003518557303535217]
# training=[5.149449642501948, 4.655602880732687, 4.0510603320770215, 3.5601891197406372, 3.121146547862188, 2.774044997882875, 2.5280730998112997, 2.33581288187329, 2.2025977052650925, 2.008915999840046, 1.92582199970216, 1.8036205686371902, 1.6738275458352159, 1.5756978334133787, 1.4778079456575826, 1.3631783211793953, 1.276709608621409, 1.1752679436590745, 1.0843352201913248, 1.0126177995628762, 0.9330318413891838, 0.8783495072580956, 0.819072563431915, 0.7703362085925404, 0.7272822613455916, 0.6779543528957513, 0.6361582514670608, 0.5968679044012805, 0.5575661325598386, 0.5278285000689021, 0.49186545069655885, 0.4694221719755231, 0.4406544775080034, 0.4108676409138698, 0.3885687621971976, 0.37091049806386045, 0.3468199700546137, 0.32667299916523135, 0.31063308786060806, 0.29031511322087894, 0.2800637669175374, 0.26594294374668365, 0.24998771837015474, 0.23630335628687038, 0.22237571378515683, 0.2097700074798972, 0.1992636355102202, 0.19277147900351801, 0.17796343754556693, 0.17161345761238153, 0.16379470189838136, 0.1538097861222611, 0.14595459423058801, 0.1392076919419653, 0.13294083696166767, 0.12789803094835156, 0.12132784583555004, 0.11695743756506569, 0.11170282346331478, 0.10318955251274198, 0.10033028306153294, 0.0961383929570303, 0.09232947081676646, 0.08806961756866834, 0.08508100398296412, 0.08130378574681674, 0.0781665446369553, 0.07454565862847844, 0.07144534647724163, 0.07098129691988239, 0.06706570198115275, 0.06229715862919105, 0.06119550108550423, 0.06038849885383098, 0.057538050610683095, 0.05459121209863919, 0.05251757474818835, 0.05098559531552519, 0.0490454629507598, 0.04663961852399011, 0.045543373848308796, 0.04379013425177621, 0.04232951788188703, 0.04055841349421994, 0.03961849242578512, 0.038196632534435136, 0.03714558794460929, 0.03581560549027232, 0.03514248073839367, 0.03412622440847059, 0.03242705897579314, 0.03136402426414119, 0.03064471670804632, 0.029224056522304254, 0.028369744066654098, 0.027177855676737844, 0.026619774683846013, 0.025425204184688292, 0.025601795226944144, 0.024173671609787867, 0.02334226301213671, 0.023412045479259805, 0.02196135360698936, 0.021375539871933552, 0.02051144098014308, 0.020341936584934966, 0.019170941423922828, 0.018702066444536494, 0.018195822690297098, 0.018203753310779204, 0.01736564626452673, 0.016748404458968344, 0.016515960821468455, 0.015916360015249747, 0.015551090469957396, 0.014703590997813097, 0.01428006100024034, 0.01441150005740947, 0.013733981383617084, 0.0128703218291426, 0.012759900897252428, 0.012447023096394292, 0.012415380103954472, 0.01155631077560965, 0.01165597709497561]
# testing=[1.7658179166475994, 1.2525386506262846, 0.9074389501545842, 1.5228990773227697, 0.8995008889209974, 0.4868208805096569, 0.7289323957809637, 0.6106350723159828, 0.6502649406457061, 0.5594262978726126, 0.4808143039578414, 0.48638142414406027, 0.22251124558740984, 0.4198654142177214, 0.3460201730449028, 0.31360066276691456, 0.1857626137553221, 0.1297054172993923, 0.20260086036090919, 0.1720409467998656, 0.16098608112823695, 
# 0.15593066090362706, 0.09590656220969411, 0.09091312616130195, 0.09274861561191106, 0.09540612603156878, 0.06647298637087756, 0.08391868831631573, 0.05362169489355528, 0.0531837457761775, 0.04554861328355894, 0.050485861020780946, 0.03999239598027621, 0.041035040549317954, 0.029356147918625806, 0.03094179089476248, 0.02543006491820217, 0.02732495559300251, 0.021387514568888027, 0.0257416899299519, 0.02086279726079733, 0.017710684020704307, 0.01853697454189455, 0.01551511653647462, 0.013094419216326971, 0.015627429440114277, 0.012788993731572515, 0.013910057111366805, 0.01203972183562757, 0.014491609196041949, 0.013719797001480002, 
# 0.013003238580050737, 0.011681792931070342, 0.0124221402873314, 0.010097309749969164, 0.01196446869497501, 0.00979547969967362, 0.009770256172792523, 0.0078058849594602985, 0.007617451550593422, 0.00826215820895384, 0.009216075118096193, 0.008431278789670572, 0.008848370228823217, 0.007699815327012702, 0.007564982942082613, 0.007722937218768225, 0.0068277949372648455, 0.00812568468546391, 0.008322922026065417, 0.0077131051231740955, 0.0064024190690658775, 0.006374621734602955, 0.00603556423998766, 0.0073594412769001655, 0.008098040294341385, 0.008394387886204507, 0.00623680866106914, 0.007009590263020021, 0.006381605887487256, 0.006139902203621925, 0.007251109096502331, 0.005781808742460814, 0.00664687251079104, 0.0061424949246009445, 0.006086579624882036, 0.0064155950393799946, 0.005643577498984953, 0.007453061407456096, 0.005636521051619649, 0.005954445816128738, 0.00661711361695059, 0.006320393993592424, 0.006279102385790379, 0.005563481283876537, 0.007373700413151653, 0.006172918469387238, 0.007516871450908118, 0.006518532595486958, 0.0062986952840429, 0.0064450995719499155, 0.006463390136505617, 0.0066758591138315945, 0.006684288935463167, 0.00690441482367587, 0.0060705645665529205, 0.005756685435409021, 0.006767363299371353, 0.006539994670134549, 0.006746972191215031, 0.005759088247534876, 0.006301018889352821, 0.0053542787074386524, 0.005715199740091622, 0.0055693637615347544, 0.005439877684338908, 0.005226422477843488, 0.004931990966814236, 0.005728401399959061, 0.005380696601893977, 0.00466783031501956, 0.004999903927604252, 0.005127339686501849, 0.004905654811616666, 0.0051180754666776485]
# bestPredicted=[0.025122793, 0.029492628, 0.024692658, 0.026749486, 0.025512574, 0.030672036, 0.029294794, 0.030455297, 0.026429784, 0.022189008, 0.025282057, 0.02963122, 0.026502628, 0.02713598, 0.028487945, 0.028218511, 0.03069889, 0.024925604, 0.024909932, 0.031135736, 0.027021397, 0.03045172, 0.02751796, 0.02650335, 0.027716111, 0.026859172, 0.026076384, 0.025859125, 0.025677955, 0.025384922]
# bestActual=[0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]

# lr=0.00001 patience=1
# validation=[2.3973559770799975, 0.26113733415214646, 0.06829019285824303, 0.03571009331044323, 0.021431175398238567, 0.014625941629278284, 0.009473072719434667, 0.007370060665806654, 0.006562839272360719, 0.006358896167112832, 0.006443672583459008]
# training=[2.3351784296069016, 0.517074089205181, 0.17262988233616783, 0.08633483014330502, 0.053577500077494886, 0.035431178032439704, 0.024052191973763157, 0.017381169798016304, 0.013166496038259813, 0.010368408658370668, 0.00835238010405755]
# testing=[0.023904928252059546, 0.0023373462144851472, 0.0004946741506425486, 0.00027871847713967126, 0.0002646901155745895, 0.00017275723204400844, 0.00016972424215700336, 7.376902161772012e-05, 0.00010071277808111944, 9.907519388274196e-05, 9.414732759340469e-05]
# bestPredicted=[0.01737351, 0.03233496, 0.010991922, 0.013767727, 0.01612926, 0.01687644, 0.033324666, 0.021572195, 0.021744743, 0.018523445, 0.015966149, 0.017849002, 0.007682468, 0.02780048, 0.027989626, 0.020619594, 0.020024829, 0.025054595, 0.016302226, 0.028181948, 0.00923188, 0.021459308, 0.018924246, 0.013898663, 0.016758233, 0.020443592, 0.013307994, 0.026001336, 0.022080425, 0.029336834]
# bestActual=[0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]
# bestPredicted=[0.01731262, 0.021982256, 0.0219928, 0.019032901, 0.01884778, 0.03174758, 0.03480009, 0.018143715, 0.01869676, 0.023587922, 0.022208055, 0.027446201, 0.023726428, 0.03127797, 0.014650254, 0.02800331, 0.018139843, 0.02598184, 0.022508996, 0.022504829, 0.018648673, 0.021423085, 0.030730793, 0.022488717, 0.032739665, 0.01451719, 0.024478631, 0.028093338, 0.027178107, 0.021657802]

# lr=0.000005 patience=1
# validation=[2.8241903113421465, 1.4635077453365302, 0.6374613511830831, 0.23811788047923946, 0.12295495318079677, 0.07877216144484683, 0.046624008617287445, 0.028796734670837217, 0.020887885094963855, 0.015751543869861807, 0.012626760738515479, 0.010623663911574542, 0.008961025299657277, 0.007975378858548089, 0.007244135320681235, 0.006683000994378657, 0.0062857981006874935, 0.006014956065539735, 0.005826324813702658, 0.0056962602565594316, 0.00566896581507673, 0.005585265750584945, 0.005543336049861388, 0.005608061978965288]
# training=[2.941655077396581, 1.5969197117311698, 0.8508101566153535, 0.49108464603531143, 0.3407396691288391, 0.21667908222289847, 0.1299400788989247, 0.08758567708010553, 0.06489255605649534, 0.05035217675902837, 0.040761262301312585, 0.033301304489771325, 0.028118100887255804, 0.02350917680755013, 0.020152785752386455, 0.0174002676076929, 0.015103849556399287, 0.013167839411268794, 0.011517847604229308, 0.010192139135861611, 0.009023830164961957, 0.008123444799988907, 0.007293128348966008, 0.006574919210902384]
# testing=[0.04844200362849043, 0.03418548691368178, 0.008830905838209802, 0.0033438928872613636, 0.0013963423162294218, 0.001844749933687494, 0.0007801430743556403, 0.0002505001009791502, 0.00010286063560099316, 0.000207725999460355, 5.810444053079664e-05, 4.883549060726966e-05, 5.3381652340245396e-05, 3.432699010784312e-05, 8.618858029918689e-05, 3.394725176551245e-05, 0.00010041927268041888, 3.236447906458707e-05, 3.8923191143332865e-05, 0.00010571093023247577, 8.347497405410102e-05, 0.00012891210994362312, 0.00010109602338050873, 5.729357935764227e-05]
# bestPredicted=[0.02133615, 0.015497976, 0.01848773, 0.018637873, 0.016683338, 0.017365906, 0.021829749, 0.018652761, 0.013294497, 0.015402159, 0.023571981, 0.012685865, 0.022966592, 0.023015652, 0.016418599, 0.020320464, 0.020646788, 0.02197062, 0.01569835, 0.013957409, 0.020091705, 0.0229659, 0.018448686, 0.012176229, 0.02095859, 0.018169712, 0.020519312, 0.01794361, 0.01586838, 0.019205946]
# bestActual=[0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]
# bestPredicted=[0.014832441, 0.025620636, 0.022241184, 0.020343218, 0.021549655, 0.018921103, 0.02329053, 0.030386232, 0.027002238, 0.021269036, 0.023730554, 0.02929779, 0.025677714, 0.026936868, 0.025756897, 0.022583129, 0.028518131, 0.02305803, 0.02796951, 0.02737353, 0.026386855, 0.02382038, 0.02817358, 0.023779022, 0.02381211, 0.018749233, 0.023539547, 0.025048604, 0.029108493, 0.023549493]

# bestPredicted=[0.019196097, 0.020935368, 0.019009253, 0.020599334, 0.018272683, 0.020848153, 0.020894025, 0.018168164, 0.018316153, 0.018437348, 0.017002802, 0.020550273, 0.01758112, 0.01740738, 0.01846, 0.017539497, 0.019433849, 0.021034027, 0.01805291, 0.018157596, 0.018238574, 0.018888775, 0.018220829, 0.017044146, 0.018345509, 0.019641064, 0.018189833, 0.0175791, 0.01671363, 0.01903685]
# bestPredicted=[0.014105441, 0.023242489, 0.02252133, 0.019764312, 0.020540252, 0.017589696, 0.023224099, 0.030795041, 0.027947234, 0.02317675, 0.023742553, 0.028209578, 0.025089791, 0.026565386, 0.027258921, 0.02242191, 0.02907242, 0.022963563, 0.02795376, 0.02715969, 0.026718639, 0.022112235, 0.027388532, 0.024080038, 0.024014104, 0.01863077, 0.024136508, 0.024538977, 0.027398843, 0.021439921]
# [0.01930532, 0.025494922, 0.019904329, 0.020059405, 0.02591939, 0.020921217, 0.022875443, 0.0307574, 0.025822435, 0.023181982, 0.026130492, 0.031928033, 0.025232568, 0.028822886, 0.026397029, 0.023689797, 0.026897043, 0.022426678, 0.028789883, 0.03142975, 0.029380277, 0.0225293, 0.030380217, 0.025250278, 0.025172027, 0.024778701, 0.025857309, 0.026631178, 0.028841477, 0.021952437]

# bestPredicted=[0.019916752, 0.02919294, 0.027209958, 0.023946552, 0.026652943, 0.024661109, 0.023695063, 0.032838933, 0.029451968, 0.022836154, 0.02717116, 0.026786596, 0.025709687, 0.027648197, 0.024564786, 0.024902008, 0.024308842, 0.018441468, 0.02755541, 0.029599747, 0.030747043, 0.022951461, 0.027229648, 0.024028614, 0.028775942, 0.021176342, 0.02836296, 0.027521124, 0.030828487, 0.027837785]
bestPredicted=[0.018058795, 0.018303994, 0.017444225, 0.017506149, 0.019086417, 0.017426655, 0.017640531, 0.018457418, 0.017042635, 0.017194167, 0.016238717, 0.019385321, 0.01829059, 0.01954031, 0.016810456, 0.018231329, 0.017620761, 0.018901967, 0.019536924, 0.019314745, 0.020510573, 0.019264024, 0.018087948, 0.01684977, 0.0192373]


# bestPredicted=[0.027478186, 0.028303016, 0.029681422, 0.02874903, 0.026555853, 0.025746392, 0.023554323, 0.023081698, 0.031666666, 0.02550126]
bestPredicted=[0.012572438, 0.016907647, 0.015226079, 0.016997315, 0.01891505, 0.01624265, 0.019283285, 0.017230757, 0.016966494, 0.016873386]
predictedActual=[0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]
bestPredicted=[0.020794457, 0.020460604, 0.020726858, 0.023066174, 0.014917489, 0.020698123, 0.02214969, 0.019375714, 0.017551702, 0.022272613, 0.017719412, 0.01960493, 0.01726866, 0.018549655, 0.017542468, 0.019773873, 0.019518718, 0.017473347, 0.017240845, 0.021638095]
# bestPredicted=[0.016865822, 0.017369635, 0.016994461, 0.018423878, 0.014910751, 0.01710533, 0.016988046, 0.015483658, 0.017195981, 0.017192613]
bestPredicted=[0.016408494, 0.01547841, 0.017689085, 0.016677978, 0.013660965, 0.014846299, 0.017494664, 0.020094559, 0.016210752, 0.01881245]
# bestPredicted=[0.016659543, 0.017460342, 0.017807513, 0.018416906, 0.01532545, 0.016941799, 0.01811881, 0.017302422, 0.015084695, 0.0174755, 0.015016129, 0.01734264, 0.015848443, 0.018238382, 0.015280625, 0.01683809, 0.016450664, 0.016659306, 0.016740596, 0.017101835]
# predictedActual=[0.020794457, 0.020460604, 0.020726858, 0.023066174, 0.014917489, 0.020698123, 0.02214969, 0.019375714, 0.017551702, 0.022272613, 0.017719412, 0.01960493, 0.01726866, 0.018549655, 0.017542468, 0.019773873, 0.019518718, 0.017473347, 0.017240845, 0.021638095]


"""
True values for each horizon
horzion10
0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054

horzion20
0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054

horzion30
0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054

"""
# Best Predictions
# bestPredicted=[0.019446072545896642, 0.023124960151588672, 0.023145691549789623, 0.011728508990211172, 0.010928682841968535, 0.01610044993324806, 0.016503484452868755, 0.0190315451295163, 0.020526663038328136, 0.01794591491670361, 0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]
# bestPredicted=[0.017254733, 0.018465936, 0.019710267, 0.018032502, 0.016448857, 0.016775656, 0.018407356, 0.019274939, 0.017271034, 0.017150015, 0.016523639, 0.017460816, 0.017484378, 0.017219275, 0.017578715, 0.018262336, 0.018203586, 0.018578542, 0.01876811, 0.018228535]
bestPredicted=[0.015810862, 0.016663127, 0.015286094, 0.01665892, 0.016231995, 0.016710324, 0.018217063, 0.017819291, 0.017824767, 0.018583214]



# True
horizon10=[0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]
horizon20=[0.019699095104683442, 0.018658373369884407, 0.022224455066162233, 0.014881787252223137, 0.011561816310989376, 0.011240934938803687, 0.012749496613611144, 0.01965686636733204, 0.01719364534159697, 0.009301115506623943, 0.009798845208230015, 0.010008374606281827, 0.013746961505450591, 0.01144433057436862, 0.01316334815606416, 0.014810359834587805, 0.015379551435126608, 0.017549473647433183, 0.017314210370024685, 0.01685871381289054]
horizon30=[0.02038531, 0.019895371, 0.019805346, 0.018156396, 0.01628622, 0.017689638, 0.016007584, 0.015961574, 0.014606599, 0.018604677, 0.018135875, 0.017880678, 0.018427117, 0.013530588, 0.017020557, 0.015388776, 0.017514884, 0.02200173, 0.019276725, 0.017523251, 0.0167111, 0.018982645, 0.01722311, 0.015696034, 0.0153235495, 0.016236853, 0.014505766, 0.014308998, 0.015675878, 0.014458036]
predictedActual = []
if len(bestPredicted)==10:
    predictedActual=horizon10
elif len(bestPredicted)==20:
    predictedActual=horizon20
else:
    predictedActual=horizon30
from sklearn.metrics import mean_absolute_percentage_error

print(mean_absolute_percentage_error(predictedActual, bestPredicted))

training_min_max_scaler = preprocessing.MinMaxScaler()
validation_min_max_scaler = preprocessing.MinMaxScaler()
testing_min_max_scaler = preprocessing.MinMaxScaler()
x = np.arange(0, len(testing))
z = np.polyfit(x, testing, 1)
p = np.poly1d(z)
print(z)
print(p)

differences = [validation[i + 1] - validation[i] for i in range(len(validation) - 1)]
print(differences)
testing = np.array(testing)
training = training_min_max_scaler.fit_transform(np.array(training).reshape(-1,1))
validation = validation_min_max_scaler.fit_transform(np.array(validation).reshape(-1,1))
testing = testing_min_max_scaler.fit_transform(np.array(testing).reshape(-1,1))


print( mean_squared_error(bestPredicted, predictedActual))
print( mean_absolute_error(bestPredicted, predictedActual))

rcParams['figure.figsize'] = 14, 8
sns.set(style='whitegrid', palette='muted', font_scale=1.5)
plt.plot(predictedActual, label='Actual CPU%', color='orange')
plt.plot(bestPredicted, label='Predicted CPU%', color='green')
plt.title('SW Transformer Workload Traffic Prediction Horizon '+str(len(bestPredicted)))
plt.xlabel('Time')
plt.ylabel('CPU%')
plt.legend(loc='best')
plt.show()


# sns.set(style='whitegrid', palette='muted', font_scale=1.5)
# # plt.plot(validation[0:], label='validation loss', color='orange')
# plt.plot(differences, label='validation loss', color='orange')
# # plt.plot(testing[0:], label='testing loss', color='blue')
# # plt.plot(training[0:], label='training loss', color='green')
# plt.title('Sliding window validation loss '+str(len(bestPredicted))+' epochs')
# plt.xlabel('epoch')
# plt.ylabel('Loss')
# plt.legend(loc='best')
# plt.show()

# plt.plot(x, p(x), label="trendline", color='red')
# plt.plot(testing, label='testing loss', color='blue')
# plt.title('Sliding window validation loss 150 epochs')
# plt.xlabel('epoch')
# plt.ylabel('Loss')
# plt.legend(loc='best')
# plt.show()



